class Solution:
    def maxPower(self, stations: List[int], r: int, k: int) -> int:
        n = len(stations)
        difference = [0] * (n + 1)

        for i in range(n):
            left = max(i - r, 0)
            right = min(i + r + 1, n)

            difference[left] += stations[i]
            difference[right] -= stations[i]

        def canAchieve(targetP):
            currP = 0
            currK = k
            difference_copy = difference.copy()

            for i in range(n):
                currP += difference_copy[i]
                if currP < targetP:
                    add = targetP - currP
                    if add > currK:
                        return False
                    currK -= add
                    currP += add
                    right = min(i + 2*r + 1, n)
                    difference_copy[right] -= add
            
            return True
        
        low, high = min(stations), sum(stations) + k
        result = low

        while low <= high:
            targetP = (low + high) // 2
            if canAchieve(targetP):
                result = targetP
                low = targetP + 1
            else:
                high = targetP - 1
            
        return result
